<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <script src="./src/jquery-3.2.1.min.js"></script>
    <script src="./src/cryptico.browser.min.js"></script>
    <title></title>
    <script>
    <!--
        $(function () {
            arg = new Object;
            var param = location.search.substring(1).split('&');
            for (var i = 0; param[i]; i++) {
                var p = param[i].split('=');
                arg[p[0]] = p[1];
            }

            if (!('modulus' in arg)) { return false; }
            var decrypted = cryptico.decrypt(arg['query'], )
            cryptico.publicKeyString()

            $('#login').click(function () {
                if (!('modulus' in arg)) { return false; }

                var chars = 'abcdefghijklmnopqrstuvwxyzABCDEFGHIJLKMNOPQRSTUVWXYZ0123456789';
                var mt = new MersenneTwister();
                var salt = "";
                for (var i = 0; i < 24; i++) {
                    salt += chars.charAt(mt.nextInt(chars.length));
                }

                var queryString = '?id=';
                if ($('#pswd-toggle').prop('checked')) { queryString += encodeURIComponent($('#pswd-text').val()); }
                else { queryString += encodeURIComponent($('#pswd').val()); }
                queryString += '&password=' + encodeURIComponent($('#j_password').val());
                queryString += '&salt=' + salt;

                var encrypted = cryptico.encrypt(queryString, decodeURIComponent(arg['modulus']));
                $('#query').val(encodeURIComponent(encrypted.cipher));
                //$('#query').val(encodeURIComponent(cryptico.encrypt(queryString, decodeURIComponent(arg['modulus'])).cipher));
                //var decrypted = crypto.decrypt(encrypted, "");

                $('#login_form').submit();
            });
        });

    //-->
    </script>
</head>
<body>
    <p>test_result.html</p>
</body>
</html>